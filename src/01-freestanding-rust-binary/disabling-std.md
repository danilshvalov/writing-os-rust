## Отключение стандартной библиотеки

По умолчанию все крейты в Rust подключают [стандартную библиотеку], которая зависит от операционной системы, для таких функций, как потоки (threads), файлы (files) или сеть (networking). Это также включает в себя зависимость от стандартной библиотеки Си (C standard library `libc`), которая взаимодействует со службами ОС. Поскольку мы планируем написать ОС, мы не можем использовать какие-либо библиотеки, зависящие от ОС. Поэтому мы должны убрать подключение стандартной библиотеки с помощью [атрибута `no_std`]

[стандартную библиотеку]: https://doc.rust-lang.org/std/
[атрибута `no_std`]: https://doc.rust-lang.org/1.30.0/book/first-edition/using-rust-without-the-standard-library.html

Начнем с создания нового cargo-проекта. Самый простой способ сделать это - с помощью командной строки:

```
cargo new blog_os
```
Я назвал проект `blog_os`, но вы, конечно, можете выбрать другое имя. Когда мы запускаем команду, cargo создает для нас следующую структуру каталогов:

```
blog_os
├── Cargo.toml
└── src
    └── main.rs
```

Файл `Cargo.toml` содержит конфигурацию крейта: имя, автора, [семантическую версию] и зависимости. Файл `src/main.rs` содержит корневой модуль нашего крейта и нашу `main` функцию. Вы можете скомпилировать ваш крейт с помощью команды `cargo build`, после чего в директории `target/debug` появится бинарный файл нашего крейта, который вы можете запустить. Чтобы скомпилировать и сразу запустить, можно воспользоваться командой `cargo run`.

[семантическую версию]: https://semver.org/

### атрибут `no_std`

Прямо сейчас наш крейт неявно подключает стандартную библиотеку. Давайте изменим это, добавив [атрибут `no_std`]:

[атрибут `no_std`]: https://doc.rust-lang.org/1.30.0/book/first-edition/using-rust-without-the-standard-library.html

```rust
// main.rs

#![no_std]

fn main() {
    println!("Hello, world!");
}
```

Если мы попробуем скомпилировать наш крейт (с помощью `cargo build`), то получим ошибку:

```
error: cannot find macro `println!` in this scope
 --> src/main.rs:4:5
  |
4 |     println!("Hello, world!");
  |     ^^^^^^^
```

Причина этой ошибки в том, что [макрос `println`] является частью стандартной библиотеки, которую мы больше не подключаем. Теперь мы не можем ничего распечатать. Это имеет смысл, поскольку `println` использует [стандартный вывод], который представляет собой специальный файловый дескриптор, предоставляемый ОС.

[макрос `println`]: https://doc.rust-lang.org/std/macro.println.html
[стандартный вывод]: https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29

Давайте удалим `println` и попробуем снова с пустой функцией `main`:

```rust
// main.rs

#![no_std]

fn main() {}
```

```
> cargo build
error: `#[panic_handler]` function required, but not found
error: language item required, but not found: `eh_personality`
```

Теперь компилятор не может найти функцию с атрибутом `#[panic_handler]` и _элемент языка_ `eh_personality`.